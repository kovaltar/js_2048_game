!function(){function t(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function e(e,i){var s=t(e,i,"get");return s.get?s.get.call(e):s.value}function i(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function s(t,e,s){i(t,e),e.set(t,s)}function n(e,i,s){var n=t(e,i,"set");return!function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(e,n,s),s}function a(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function r(t,e){i(t,e),e.add(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=Array(e);i<e;i++)s[i]=t[i];return s}var h=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakSet,f=new WeakSet,v=new WeakSet,g=new WeakSet,d=new WeakSet,p=new WeakSet,y=new WeakSet,m=new WeakSet,w=new WeakSet,S=new WeakSet,k=new WeakSet,b=new WeakSet;function L(t){var e=[];return t.flat().forEach(function(t,i,s){0===t&&e.push(i)}),e}function M(t){var e=a(this,u,L).call(this,t);if(e.length){var i=Math.floor(Math.random()*e.length),s=e[i];return[Math.floor(s/4),s%4]}}function W(t){if(a(this,b,J).call(this),"idle"===e(this,h)||"playing"===e(this,h)){var i=a(this,f,M).call(this,t);1===Math.floor(1+10*Math.random())?t[i[0]][i[1]]=4:t[i[0]][i[1]]=2}}function A(t){return t.filter(function(t,e,i){return 0!==t})}function T(t,e){for(var i=[],s=0;s<t.length;s++)i.push(t[s][e]);return i}function E(t){for(var i=t.concat(),s=[],a=i.length-1;a>=0;a--)i[a]===i[a-1]?(i[a]*=2,n(this,c,e(this,c)+i[a]),s.push(i[a]),i.splice(i.length-2,2)):s.push(i.splice(a,1)[0]),a=i.length;if(s.length<4)for(var r=s.length;r<4;r++)s.push(0);return s.reverse(),s}function H(t){for(var i=t.concat(),s=[],a=0;a<i.length;a++)i[a]===i[a+1]?(i[a]*=2,n(this,c,e(this,c)+i[a]),s.push(i[a]),i.splice(0,a+2)):s.push(i.splice(0,1)[0]),a-=1;if(s.length<4)for(var r=s.length;r<4;r++)s.push(0);return s}function O(t,e){return t.length===e.length&&t.every(function(t,i){return t===e[i]})}function j(t){var e,i;return(e=Math).max.apply(e,function(t){if(Array.isArray(t))return l(t)}(i=t.flat())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return l(t,void 0);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,void 0)}}(i)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}function N(t){if(t.flat().includes(0))return!0;for(var e=0;e<t.length;e++){var i=t[e],s=a(this,d,T).call(this,t,e);if(a(this,k,q).call(this,i)||a(this,k,q).call(this,s))return!0}return!1}function q(t){return t.some(function(e,i,s){return 0!==i&&e===t[i-1]})}function J(){return a(this,m,O).call(this,this.initialState.flat(),this.state.flat())&&a(this,S,N).call(this,this.state)&&2048>a(this,w,j).call(this,this.state)?n(this,h,"idle"):a(this,w,j).call(this,this.state)>=2048?n(this,h,"win"):!a(this,S,N).call(this,this.state)&&2048>a(this,w,j).call(this,this.state)?n(this,h,"lose"):n(this,h,"playing"),e(this,h)}var R=new(function(){var t;function i(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),r(this,u),r(this,f),r(this,v),r(this,g),r(this,d),r(this,p),r(this,y),r(this,m),r(this,w),r(this,S),r(this,k),r(this,b),s(this,h,{writable:!0,value:"idle"}),s(this,o,{writable:!0,value:[]}),s(this,c,{writable:!0,value:0}),this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.state=JSON.parse(JSON.stringify(this.initialState))}return t=[{key:"moveLeft",value:function(){for(var t=0;t<this.state.length;t++){var i=this.state[t],s=a(this,y,H).call(this,a(this,g,A).call(this,i)),n=!1;if(n=!a(this,m,O).call(this,i,s),e(this,o).push(n),n)for(var r=0;r<s.length;r++)i[r]=s[r]}e(this,o).includes(!0)&&(a(this,v,W).call(this,this.state),e(this,o).length=0),a(this,b,J).call(this)}},{key:"moveRight",value:function(){for(var t=0;t<this.state.length;t++){var i=this.state[t],s=a(this,p,E).call(this,a(this,g,A).call(this,i)),n=!1;if(n=!a(this,m,O).call(this,i,s),e(this,o).push(n),n)for(var r=0;r<s.length;r++)i[r]=s[r]}e(this,o).includes(!0)&&(a(this,v,W).call(this,this.state),e(this,o).length=0),a(this,b,J).call(this)}},{key:"moveUp",value:function(){for(var t=0;t<this.state.length;t++){var i=a(this,d,T).call(this,this.state,t),s=a(this,y,H).call(this,a(this,g,A).call(this,i)),n=!1;if(n=!a(this,m,O).call(this,i,s),e(this,o).push(n),n)for(var r=0;r<s.length;r++)this.state[r][t]=s[r]}e(this,o).includes(!0)&&(a(this,v,W).call(this,this.state),e(this,o).length=0),a(this,b,J).call(this)}},{key:"moveDown",value:function(){for(var t=0;t<this.state.length;t++){var i=a(this,d,T).call(this,this.state,t),s=a(this,p,E).call(this,a(this,g,A).call(this,i)),n=!1;if(n=!a(this,m,O).call(this,i,s),e(this,o).push(n),n)for(var r=0;r<s.length;r++)this.state[r][t]=s[r]}e(this,o).includes(!0)&&(a(this,v,W).call(this,this.state),e(this,o).length=0),a(this,b,J).call(this)}},{key:"getScore",value:function(){return e(this,c)}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return e(this,h)}},{key:"start",value:function(){a(this,b,J).call(this),a(this,v,W).call(this,this.state),a(this,v,W).call(this,this.state)}},{key:"restart",value:function(){n(this,h,"idle"),this.state=JSON.parse(JSON.stringify(this.initialState)),n(this,c,0)}}],function(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(i.prototype,t),i}()),U=document.querySelector(".button.start"),C=document.querySelector(".game-score"),D=document.querySelectorAll(".field-cell");function I(t){var e=t.className.match(/(\d+)/g);return e?e[0]:0}function x(t){for(var e=document.querySelectorAll(".message"),i=0;i<e.length;i++){var s=e[i];s.classList.contains("message-".concat(t))?s.classList.contains("hidden")&&s.classList.remove("hidden"):s.classList.contains("hidden")||s.classList.add("hidden")}}function z(){for(var t=0;t<D.length;t++){var e=D[t],i=R.getState().flat()[t];i!==+e.innerHTML&&(0!==i?e.innerHTML=String(i):e.innerHTML=""),I(e)!==e.innerHTML&&(e.classList.remove("field-cell--".concat(I(e))),e.classList.add("field-cell--".concat(i)))}switch(C.innerHTML=R.getScore(),R.getStatus()){case"win":case"lose":x(R.getStatus());break;case"idle":x("start");break;case"playing":x()}}function P(t){switch(t.key){case"ArrowLeft":R.moveLeft();break;case"ArrowRight":R.moveRight();break;case"ArrowUp":R.moveUp();break;case"ArrowDown":R.moveDown()}z()}z(),U.addEventListener("click",function(){U.classList.contains("restart")?(document.removeEventListener("keydown",P),U.innerHTML="Start",U.classList.remove("restart"),R.restart()):(R.start(),document.addEventListener("keydown",P),"playing"===R.getStatus()&&(U.classList.add("restart"),U.innerHTML="Restart")),z()})}();
//# sourceMappingURL=index.bedc8422.js.map
